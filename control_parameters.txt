#########################################################################################################################
#
#					CONFIGURATION FILE FOR CONTROL v1.0: CUTE AUTONOMOUS DATA REDUCTION PIPELINE
#
#************************************************************************************************************************
#Please note: Comments and empty lines have to start with '#'. 
#Use '#' also for parameters not used. 
# 
#************************************************************************************************************************
#
data_path  			= 'D:\simulator_output\kelt9\sym\wave\data\'
#temp_path 			= 
#out_path  			= 
steps 	   			= 'extract,bg_sub,wcalib'
hb_map	   			= 'D:\simulator_output\kelt9\reduction\extra\masker.fits'
#master_bias_file 	=
#master_dark_file 	=
#master_flat_file 	=
save_temp_files	  	= 1	
bias_combine_type 	= median
dark_combine_type 	= median
flat_combine_type 	= median 
saturation_limit	= 7200
sigma_deviation   	= 5
#cosmic_ray_clip  	= 
#cent_poly_degree 	=
trace_type			= 'simple'
centroid			= 256.5	
slope 				= -9.76e-4
width 				= 10		
upper 				= 6		
lower 				= 4		
threshold			= 0.01	
background_trace 	= 'D:\simulator_output\kelt9\reduction\extra\background_trace.txt'
wavecal_mode	 	= 'crscor'
wavecal_file	 	= 'D:\simulator_output\kelt9\reduction\extra\wavelength.txt'
stellar_params	 	= 'D:\simulator_output\kelt9\reduction\extra\stellar_params.txt'
model_file		 	= 'D:\cutedrndl\'
flux_cal		 	= ''
#
#************************************************************************************************************************
#COMMENTS
# This software is intented to be fully automated, aimed at producing science-quality output with a single command line with zero user interference for CUTE data. 
# It can be easily used for any single order spectral data in any wavelength without any modification. 
#
#01. Path locations: Data path, intermediate file path and output file path. 
#		If data path is not provided it is assumed to be the current directory.
#		If intermediate file path and output file path are not provided they are created in the data path.
#02. The user has the option to select individual steps during reduction. The options are as follows
#		hb_correction,create_mbias,create_mdark,create_mflat,cr_bias,cr_dark,cr_flat,cr_cosmic,extract,bg_sub,wcalib,fluxcalib,light_curve,retrieval,level3,all
#		hb_correction: Hot and bad pixel correction
#		create_mbias: Create master bias.
#		create_mdark: Create master dark.
#		create_mflat: Creatze master flat.
#		cr_bias: Correct for bias in science frames.
#		cr_dark:Correct for dark in science frames.
#		cr_flat:Correct for flat in science frames.
#		cr_cosmic: correct for cosmic rays in science frames.
#		extract: Define the trace and extract the spectrum.
#		bg_sub: subtract background from the spectrum.
#		wcalib: Do wavelength calibration.
#		fluxcalib: Do Flux calibration.
#		light_curve: Create three light curves form the data.
#		retrieval: Process the flux and wavelength calibrated spectra to obtain transmission spectra.
#		level3: Carry out all process required for generating Level 3 data of CUTE, ie.,  flux and wavelength calibrated 1-D spectra. 
#		all: Execute all the steps. This is also the default option if steps keyword is absent.
#03. Location of hot and bad pixel map. The location of map of cosmetic defects on the CCD as a FITS file with the same sizes as the input CCD frame 
#		byte-type pixels (8-bit) and values of 1B for good pixels and 0B for bad once. 
#04. Location of master calibration files if available.
#		This include locations of master bias, master dark and/or master flat files (as fits files). 
#05. Set save_temp_files equal to 1 if you need all the intermediate files to be saved to the intermediate file directory.
#06. Options for master file creation.
#		Statistical method to create master files. Options are: 'median', 'mean' or 'mode'
#		Threshold for rejection of pixels: sigma_deviation(how many sigma's from mean value of the frame.
#		Saturation_level sets the saturation limit of CCD. if not set default of 72000 is used.	
#07. Cosmic Ray correction options: Level of cr clipping for LA cosmic algorithm. Default value set the code is 800
#08. Trace parameters
#		Degree for centroid polynomial: Default is 1.
#		Trace type used for extraction. The options are: 'simple','fixed','variable','function'. for details of these options refer to the manual.
#		Additional parameters required for different trace options:
#			centroid  : Centroid will be calculated if not provided
#			slope	  : Required for option: simple and fixed, which defines the slope of the spectrum 
#			width 	  : Required for option: simple, which defines the width of the spectrum 
#			upper 	  : Required for option: fixed, which defines the upper width of the spectrum 
#			lower 	  : Required for option: fixed, which defines the lower width of the spectrum 
#			threshold :	Required for option: variable or function, which defines the threshold from the maximum/peak of the spectrum. 
#		File location for information of where to extract background. The user could also provide it as fixed number which corresponds to the shift in pixels from centroid. 
#09. Wavelength calibration variables
#		Type of wavelength calibration required: Options are 'simple' and 'crscor'
#		Location of wavelength file. A text file with length equal to number of pixels in cross dispersion direction representing wavelength to pixel mapping.
#		A location of look up table for stellar parameters. Required only for the option crscor so as to compare with a model data. 
#		If this look up table is not provided then the model file should be the a two column model file of wavelength vs flux.  
#		Location of synthetic spectrum (model_file) for cross-correlation. CONTROL assumes that folder are named by their temperature and file are named as model.flx or
#		a two column model file of wavelength vs flux, if stellar parameters look up table is not provided.  
#10. Flux calibration variables
#		Location of flux calibration file which provides wavelength vs response relation.
##
#*************************************************************************************************************************************************************
# The program works in a series of steps following standard CCD reduction techniques user can also select individual modules using the step function described above.
# A reduction log is created to help users with processes carried out and mentioning the different parameters used if any.
# The steps involved in the program execution are as follows:
#
#		1. Prepare: Check for the different input parameters are set variables accordingly. If data files are present classify them according to file type.
#		2. Hot and bad pixel correction: Correct for hot and bad pixels in the frames.
#		3. Create master bias: Create a master bias if master bias file is not found from a set of bias files.
#		4. Create master dark: Create a master dark if master dark file is not found from a set of dark files.
#		5. Create master flat: Create a master flat if master flat file is not found from a set of flat files.
#		6. Correct for bias: Correct of the effect of bias in science frames.
#		7. Correct for dark: Correct of the effect of dark in science frames.
#		8. Correct for flat: Correct of the effect of flat in science frames.
#		9. Correct for cosmic rays: Correct for the effect of cosmic rays using LA cosmic algorithm. 
#		10.Extract spectrum: Define spectrum trace and extract the spectrum.
#		11.Subtract Background: Subtract background from spectrum.
#		12.Wavelength calibration: Do wavelength calibration
#		13.Flux calibration: Do flux calibration
#		14.Default Light curve: Create 3 light curves (short, middle and long wavelength)
#		15.Transmission spectrum: Retrie transmission spectrum.
#########################################################################################################################
